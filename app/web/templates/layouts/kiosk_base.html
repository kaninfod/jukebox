<!DOCTYPE html>
<html lang="en" class="kiosk-mode">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block title %}Jukeplayer{% endblock %}</title>
    <link rel="icon" href="data:,">
    {% include '_global_styles.html' %}
    <link rel="stylesheet" href="/static/css/mdi.css">
    <link rel="stylesheet" href="/static/css/kiosk.css">
    {% block head_extra %}{% endblock %}
</head>
<body class="kiosk-layout">
    <!-- Kiosk fixed layout structure (1280Ã—720 landscape) -->
    
    <!-- Status Bar at top (increased by 25% for better touch) -->
    <div style="height: 62px; min-height: 62px; max-height: 62px; flex-shrink: 0;">
        {% include 'components/kiosk/_status_bar.html' %}
    </div>

    <!-- Main content area with navigation and dynamic content -->
    <div class="kiosk-main-content d-flex" style="height: 558px; min-height: 558px; max-height: 558px; flex-shrink: 0; flex-grow: 0; overflow: hidden;">
        <!-- Left navigation sidebar (increased by 50% for better touch) -->
        {% include 'components/kiosk/_navigation.html' %}
        
        <!-- Dynamic content area -->
        <div id="kiosk-content-area" class="flex-grow-1">
            {% block kiosk_content %}{% endblock %}
        </div>
    </div>

    <!-- Controls fixed at bottom -->
    <div style="height: 100px; min-height: 100px; max-height: 100px; flex-shrink: 0;">
        {% include 'components/kiosk/_controls.html' %}
    </div>

    <!-- Toast container for global notifications -->
    <div id="kiosk-toast-container" class="toast-container position-fixed bottom-0 end-0 p-3" style="z-index: 1080;"></div>
    
    <!-- Kiosk-specific JavaScript -->
    <script src="/static/js/kiosk-toast.js"></script>
    <script>
      // Global API configuration
      const API_KEY = "{{ config.API_KEY }}";
      // Helper function for authenticated API calls
      function apiFetch(url, options = {}) {
        const headers = options.headers || {};
        if (API_KEY) {
          headers['X-API-Key'] = API_KEY;
        }
        return fetch(url, { ...options, headers });
      }
    </script>
    <script src="/static/js/kiosk-loader.js"></script>
    <!-- Load all kiosk component scripts upfront (small files, better for caching) -->
    <script src="/static/js/kiosk/player-status.js"></script>
    <script src="/static/js/kiosk/playlist-view.js"></script>
    <script src="/static/js/kiosk/media-library.js"></script>
    <script src="/static/js/kiosk/device-selector.js"></script>
    <script src="/static/js/kiosk/system-menu.js"></script>
    <script src="/static/js/kiosk/nfc-encoding.js"></script>
    {% block scripts %}{% endblock %}
</body>
</html>
