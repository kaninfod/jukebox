{% extends "_base.html" %}

{% block title %}Subsonic Artists{% endblock %}

{% block active_page %}library{% endblock %}

{% block content %}
    <nav aria-label="breadcrumb" class="mb-3">
        <ol class="breadcrumb">
            <li class="breadcrumb-item active" aria-current="page">Music Library</li>
        </ol>
    </nav>

    <div class="sticky-top bg-body pt-2 pb-2 border-bottom">
        <h2 class="h4 text-center mb-2">Subsonic Artists</h2>
        <div id="artist-groups" class="d-flex justify-content-center gap-2 my-2"></div>
    </div>

    <div class="table-responsive mt-3">
        <table id="artists-table" class="table table-sm align-middle">
            <thead>
                <tr>
                    <th scope="col">Artist Name</th>
                    <th scope="col">Artist ID</th>
                </tr>
            </thead>
            <tbody>
                {% for artist in artists %}
                    <tr data-artist-name="{{ artist.name|upper }}">
                        <td>
                            <a href="/library/artists/{{ artist.id }}?artist_name={{ artist.name|urlencode }}">{{ artist.name }}</a>
                        </td>
                        <td class="text-muted">{{ artist.id }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
{% endblock %}

{% block scripts %}
<script>
    // Artist group quick links (Bootstrap buttons)
    const groups = [
        { name: 'A-D', range: ['A', 'D'] },
        { name: 'E-H', range: ['E', 'H'] },
        { name: 'I-L', range: ['I', 'L'] },
        { name: 'M-P', range: ['M', 'P'] },
        { name: 'Q-T', range: ['Q', 'T'] },
        { name: 'U-Z', range: ['U', 'Z'] },
    ];
    const groupDiv = document.getElementById('artist-groups');
    groups.forEach(group => {
        const btn = document.createElement('button');
        btn.type = 'button';
        btn.className = 'btn btn-primary btn-sm';
        btn.textContent = group.name;
        btn.onclick = () => {
            const rows = document.querySelectorAll('#artists-table tbody tr[data-artist-name]');
            for (const row of rows) {
                const name = row.getAttribute('data-artist-name');
                if (name && name[0] >= group.range[0] && name[0] <= group.range[1]) {
                    row.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    row.classList.add('table-info');
                    setTimeout(() => row.classList.remove('table-info'), 1200);
                    break;
                }
            }
        };
        groupDiv.appendChild(btn);
    });
</script>
{% endblock %}
